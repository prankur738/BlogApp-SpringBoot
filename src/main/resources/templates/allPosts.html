<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" xmlns:th="http://www.thymeleaf.org">
    <style>
        .container{
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;;
            gap: 10px;
        }

        .item{
            border: 1px solid black;
            height: auto;
        }


    </style>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">

    <title>Home</title>
</head>
<body>
<a th:href="@{/filter}"><button>Filter</button> </a>

<form th:action="@{'/'}">

    <input type="hidden" name="author" th:value="${authors}">
    <input type="hidden" name="tag" th:value="${tags}">
    <input type="hidden" name="search" th:value="${search}">

    <select name="sortField">
        <option  value="author">Author</option>
        <option  value="publishedAt">Published At</option>
    </select>

    <select name="order">
        <option  value="asc">Ascending</option>
        <option  value="desc">Descending</option>
    </select>

    <input type="submit" value="Sort">

</form>
<form th:action="@{ '/'  }">
    <input name="search" placeholder="search"/>
    <input type="submit" value="Submit">
</form>

<div class="container">
    <div class="item" th:each="post : ${posts}" >
        <h5 th:text="${post.title}" ></h5>
        <p th:text="${post.excerpt}"></p>
        <p th:text="${post.author}"></p>
        <p th:text="${post.createdAt}"></p>
        <div class="tag_container">
            Tags:
            <div class="tag_item" th:each="t : ${post.tags}" >
                <span style="display: inline;" th:text="${t.name}" ></span>
            </div>
        </div>

        <div style="display: flex; gap: 10px;">

        <form th:action="@{/viewPost}">
            <input type="hidden"  name="postId" th:value="${post.id}"/>
            <input type="submit" value="View"/>
        </form>

        <form th:action="@{/editPost}">
            <input type="hidden"  name="postId" th:value="${post.id}"/>
            <input type="submit" value="Edit"/>
        </form>

        <form th:action="@{/deletePost}">
            <input type="hidden"  name="postId" th:value="${post.id}"/>
            <input type="submit" value="Delete"/>
        </form>
        </div>

    </div>
</div>



<!--pagination-->
<nav aria-label="Page navigation example">
    <ul class="pagination">
        <li th:if="${currentPage != 1}" class="page-item">
            <a th:href="@{ '/?page = '+${currentPage-1} +'&author=' + ${authors} + '&tag=' + ${tags} +
            '&search=' + ${search} + '&sortField=' + ${sortField} + '&order=' + ${order} }"
               class="page-link" >Previous</a></li>
<!--        (totalPages==0?1:totalPages)-->
        <li th:classappend="${currentPage==pageNo?'active':''}" th:each="pageNo : ${#numbers.sequence(1,(totalPages==0?1:totalPages))}"
            class="page-item">

        <a th:href="@{ '/?page=' + ${pageNo} +'&author=' + ${authors} + '&tag=' + ${tags} +
        '&search=' + ${search} + '&sortField=' + ${sortField} + '&order=' + ${order} }" class="page-link" >
            <span th:text="${pageNo}"></span></a></li>

        <li th:if="${currentPage != totalPages}" th:class="page-item"><a
                th:href="@{ '/?page=' + ${currentPage+1} +'&author=' + ${authors} + '&tag=' + ${tags} +
                '&search=' + ${search} + '&sortField=' + ${sortField} + '&order=' + ${order} }" class="page-link" >Next</a></li>
    </ul>
</nav>
</body>
</html>